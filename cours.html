<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cours - Université Mahia</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Poppins:wght@300;400;600;700&family=Space+Mono&display=swap');
        :root { /* ... (variables CSS inchangées) ... */ }
        body, html { margin: 0; font-family: var(--font-body); background-color: var(--color-bg); color: var(--color-text); height: 100%; overflow: hidden; }
        .app-container { display: flex; flex-direction: column; height: 100vh; }
        .app-header { /* ... */ }
        .module-progress-bar { width: 100%; height: 8px; background-color: #e0e0e0; flex-shrink: 0; }
        .module-progress { height: 100%; background-color: var(--color-secondary); width: 0%; transition: width 0.5s ease-in-out; }
        .lesson-workspace { display: flex; flex-grow: 1; overflow: hidden; }
        .lesson-instructions { width: 40%; padding: 30px; background-color: #fff; overflow-y: auto; border-right: 1px solid #e0e0e0; }
        .lesson-instructions h2 { font-family: var(--font-title); margin-top: 0; font-size: 2em; }
        .lesson-instructions p { line-height: 1.8; }
        .code-environment { flex-grow: 1; display: flex; flex-direction: column; background-color: #1e1e1e; }
        .code-editor { flex-grow: 1; padding: 20px; color: #d4d4d4; font-family: var(--font-code); font-size: 14px; }
        .kairos-chat { width: 300px; background-color: #fff; border-left: 1px solid #e0e0e0; display: flex; flex-direction: column; }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <a href="index.html" style="text-decoration: none; display: flex; align-items: center; gap: 15px;">
                <svg class="logo-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M20 10 L50 40 L20 70" stroke="#333" stroke-width="10" fill="none" stroke-linecap="round" stroke-linejoin="round"/><path d="M50 40 L80 10" stroke="var(--color-secondary)" stroke-width="10" fill="none" stroke-linecap="round" stroke-linejoin="round"/><path d="M50 40 L80 70" stroke="var(--color-secondary)" stroke-width="10" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <h1 class="logo-title">Université Mah<span>ia</span></h1>
            </a>
        </header>
        <div class="module-progress-bar">
            <div class="module-progress" id="module-progress"></div>
        </div>
        <main class="lesson-workspace">
            <aside class="lesson-instructions" id="lesson-instructions">
                <h2 id="lesson-title">Chargement...</h2>
                <p id="lesson-description"></p>
            </aside>
            <section class="code-environment"><div class="code-editor"><p style="color: #888;">// L'environnement de développement apparaîtra ici.</p></div></section>
            <aside class="kairos-chat"><p style="padding: 20px; color: #888;">// Le chat avec Kairos apparaîtra ici.</p></aside>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const lessonTitleEl = document.getElementById('lesson-title');
            const lessonDescriptionEl = document.getElementById('lesson-description');
            const moduleProgressEl = document.getElementById('module-progress');
            const urlParams = new URLSearchParams(window.location.search);
            const lessonId = urlParams.get('lessonId');
            const API_BASE_URL = 'https://kairos-api-njhr.onrender.com';

            if (!lessonId) { /* ... */ return; }

            try {
                const response = await fetch(`${API_BASE_URL}/mahia/lessons/${lessonId}`);
                if (!response.ok) { throw new Error('Erreur...'); }
                const lessonData = await response.json();
                
                lessonTitleEl.textContent = lessonData.title;
                lessonDescriptionEl.textContent = lessonData.description;
                document.title = `${lessonData.title} - Université Mahia`;

                if (lessonData.module && lessonData.module.lessons) {
                    const totalLessons = lessonData.module.lessons.length;
                    const currentLessonIndex = lessonData.order;
                    const progressPercentage = ((currentLessonIndex + 1) / totalLessons) * 100;
                    
                    // On anime la barre de progression
                    setTimeout(() => {
                        moduleProgressEl.style.width = `${progressPercentage}%`;
                    }, 100);
                }

            } catch (error) { /* ... */ }
        });
    </script>
</body>
</html>